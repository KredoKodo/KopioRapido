<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:KopioRapido.ViewModels"
             x:Class="KopioRapido.MainPage"
             x:DataType="viewmodels:MainViewModel"
             Title="KopioRapido"
             Shell.NavBarIsVisible="False">

    <ContentPage.Background>
        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#8B5CF6" Offset="0.0" /> <!-- Source: Purple -->
            <GradientStop Color="#A78BFA" Offset="0.5" /> <!-- Action: Light Purple -->
            <GradientStop Color="#67E8F9" Offset="1.0" /> <!-- Dest: Cyan -->
        </LinearGradientBrush>
    </ContentPage.Background>

    <!-- Root Grid to capture drag gestures anywhere -->
    <Grid HorizontalOptions="Fill" VerticalOptions="Fill" BackgroundColor="Transparent">
        <Grid.GestureRecognizers>
            <TapGestureRecognizer Tapped="OnWindowDrag" />
            <PanGestureRecognizer PanUpdated="OnWindowPan" />
        </Grid.GestureRecognizers>

        <!-- Close Button (Moved to Root Grid) -->
        <Button Text="âœ•"
                TextColor="White"
                BackgroundColor="Transparent"
                FontSize="18"
                FontAttributes="Bold"
                WidthRequest="40"
                HeightRequest="40"
                CornerRadius="20"
                VerticalOptions="Start"
                Margin="15"
                Clicked="OnCloseClicked"
                ZIndex="100">
            <Button.HorizontalOptions>
                <OnPlatform x:TypeArguments="LayoutOptions">
                    <On Platform="Windows" Value="End" />
                    <On Platform="MacCatalyst" Value="Start" />
                </OnPlatform>
            </Button.HorizontalOptions>
            <Button.Shadow>
                <Shadow Brush="Black"
                        Offset="0,2"
                        Radius="4"
                        Opacity="0.2" />
            </Button.Shadow>
        </Button>

        <!-- Main Content Container -->
        <Border Margin="30"
                StrokeThickness="1"
                Stroke="rgba(255,255,255,0.1)"
                BackgroundColor="Transparent">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="20" />
            </Border.StrokeShape>
            
            <Grid RowDefinitions="*,*">
                <!-- Top Half: Darker Background with Top Rounded Corners -->
                <Border Grid.Row="0"
                        StrokeThickness="0">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#1E293B" Offset="0.0" />
                            <GradientStop Color="#1E293B" Offset="0.85" />
                            <GradientStop Color="#001E293B" Offset="1.0" />
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="30,30,0,0" />
                    </Border.StrokeShape>
                    <Grid>
                        <!-- Data Tracks / Bus Lines -->
                        <HorizontalStackLayout HorizontalOptions="Center" 
                                               VerticalOptions="Fill" 
                                               Spacing="8" 
                                               Opacity="0.8">
                            <!-- Left Line: Orange -> Teal -->
                            <BoxView WidthRequest="6" VerticalOptions="Fill">
                                <BoxView.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <GradientStop Color="#FF9F1C" Offset="0.0" /> <!-- Brighter Orange -->
                                        <GradientStop Color="#2EC4B6" Offset="1.0" /> <!-- Bright Light Teal -->
                                    </LinearGradientBrush>
                                </BoxView.Background>
                                <BoxView.Shadow>
                                    <Shadow Brush="#FF9F1C" Offset="0,0" Radius="10" Opacity="0.8" />
                                </BoxView.Shadow>
                            </BoxView>

                            <!-- Right Line: Red-Orange -> Light Blue -->
                            <BoxView WidthRequest="6" VerticalOptions="Fill">
                                <BoxView.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <GradientStop Color="#FF4500" Offset="0.0" /> <!-- Bright Red-Orange -->
                                        <GradientStop Color="#4CC9F0" Offset="1.0" /> <!-- Bright Light Blue -->
                                    </LinearGradientBrush>
                                </BoxView.Background>
                                <BoxView.Shadow>
                                    <Shadow Brush="#FF4500" Offset="0,0" Radius="10" Opacity="0.8" />
                                </BoxView.Shadow>
                            </BoxView>
                        </HorizontalStackLayout>
                    </Grid>
                </Border>
            
            <!-- Bottom Half: Glassy Overlay Effect with Rounded Corners -->
            <!-- Negative top margin to pull it up over the top box -->
            <Border Grid.Row="1"
                    Margin="0,-30,0,0"
                    BackgroundColor="#1AFFFFFF"
                    StrokeThickness="0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="30,30,30,30" />
                </Border.StrokeShape>
                <Border.Shadow>
                    <Shadow Brush="Black"
                            Offset="0,0"
                            Radius="20"
                            Opacity="0.5" />
                </Border.Shadow>
                <Grid>
                    <!-- Content Placeholder -->
                </Grid>
            </Border>
            
            <!-- Separator Line -->
            <BoxView Grid.Row="0"
                     VerticalOptions="End"
                     HeightRequest="1"
                     Color="rgba(255,255,255,0.1)" />
        </Grid>
    </Border>
    </Grid>

</ContentPage>
